{#
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 # http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-#}
{% extends "admin/base.html" %}

{% block title %}Verdict Details{% endblock %}

{% block breadcrumb %}
  <li><a href="{{ request.route_path('admin.verdicts.list') }}">Verdicts</a></li>
  <li class="active">{{ verdict.id }}</li>
{% endblock %}

{% block content %}
  <div class="box box-primary">
    <div class="box-body box-profile">
      <table class="table table-hover">
        <tr>
          <th scope="row">Message</th>
          <td>{{ verdict.message }}</td>
        </tr>
        <tr>
          <th scope="row">Run Date</th>
          <td>{{ verdict.run_date }}</td>
        </tr>
        <tr>
          <th scope="row">Check</th>
          <td>
            <a href="{{ request.route_path('admin.checks.detail', check_name=verdict.check.name) }}">
              {{ verdict.check.name }} v{{ verdict.check.version }}
            </a>
          </td>
        </tr>
        <tr>
          <th scope="row">Object</th>
          <td>{% include 'object_link.html' %}</td>
        </tr>
        {% if verdict.manually_reviewed %}
        <tr>
          <th scope="row">Reviewer Verdict</th>
          <td>{{ verdict.reviewer_verdict.value }}</td>
        </tr>
        {% endif %}
        <tr>
          <th scope="row">Check Verdict</th>
          <td>{{ verdict.classification.value }}</td>
        </tr>
        <tr>
          <th scope="row">Confidence</th>
          <td>{{ verdict.confidence.value }}</td>
        </tr>
        {% if verdict.full_report_link %}
        <tr>
          <th scope="row">Full Report Link</th>
          <td>{{ verdict.full_report_link }}</td>
        </tr>
        {% endif %}
        {% if verdict.details %}
        <tr>
          <th scope="row">Additional Details</th>
          <td><pre>{{ verdict.details|tojson(indent=4) }}</pre></td>
        </tr>
        {% endif %}
        <tr>
          <th scope="row">{{ "Change" if verdict.manually_reviewed else "Set"}} Verdict</th>
          <td>
            <form class="form-inline" method="POST" action="{{ request.route_path('admin.verdicts.review', verdict_id=verdict.id) }}">
              <input name="csrf_token" type="hidden" value="{{ request.session.get_csrf_token() }}">
              <select class="form-control" name="classification">
                <option disabled selected></option>
                {% for c in classifications %}
                <option>{{ c }}</option>
                {% endfor %}
              </select>
              <button type="submit" class="btn btn-primary">Save</button>
            </form>
          </td>
        </tr>
      </table>
    </div>
  </div>
{% endblock %}
