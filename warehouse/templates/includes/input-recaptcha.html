{% macro recaptcha_html(request, form) -%}
  {% if request.find_service(name="recaptcha").enabled %}
  {% if form.g_recaptcha_response.errors %}
  <ul class="errors">
    {% for error in form.g_recaptcha_response.errors %}
    <li>{{ error }}</li>
    {% endfor %}
  </ul>
  {% endif %}
  <div class="g-recaptcha" data-sitekey="{{ request.registry.settings['recaptcha.site_key'] }}"></div>
  {% endif %}
{%- endmacro %}

{% macro recaptcha_src(request) -%}
  {% if request.find_service(name="recaptcha").enabled %}
    <script src="//www.google.com/recaptcha/api.js" async defer></script>
  {% endif %}
{%- endmacro %}
