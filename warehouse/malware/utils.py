from warehouse.malware.models import MalwareCheck, MalwareCheckState


def get_enabled_checks(session):
    checks = (
        session.query(MalwareCheck.name, MalwareCheck.hook_name)
        .filter(MalwareCheck.state == MalwareCheckState.enabled)
        .all()
    )
    results = {}

    for check_name, object_type in checks:
        if object_type in results:
            results[object_type].append(check_name)
        else:
            results[object_type] = [check_name]

    return results
