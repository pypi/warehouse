from warehouse.malware.checks.base import MalwareCheckBase
from warehouse.malware.models import (
    MalwareVerdict,
    VerdictClassification,
    VerdictConfidence,
)

VERSION = 1
SHORT_DESCRIPTION = "An example hook-based check"
LONG_DESCRIPTION = """The purpose of this check is to demonstrate the implementation \
of a hook-based check. This check will generate verdicts if enabled."""


class ExampleCheck(MalwareCheckBase):

    version = VERSION
    short_description = SHORT_DESCRIPTION
    long_description = LONG_DESCRIPTION

    def __init__(self, check_id):
        super().__init__()
        self.id = check_id

    def run(self, request, file_id):
        verdict = MalwareVerdict(
            check_id=self.id,
            file_id=file_id,
            classification=VerdictClassification.benign,
            confidence=VerdictConfidence.High,
            message="Nothing to see here!",
        )
        request.db.add(verdict)
