import yara

from warehouse.malware.checks import SetupPatternCheck
from warehouse.malware.models import MalwareCheckState

from ...common.db.malware import MalwareCheckFactory


def test_initializes(db_session):
    check_model = MalwareCheckFactory.create(
        name="SetupPatternCheck", state=MalwareCheckState.Enabled
    )
    check = SetupPatternCheck(db_session)

    assert check.id == check_model.id
    assert isinstance(check._yara_rules, yara.Rules)
